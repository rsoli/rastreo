"use strict";(self.webpackChunkkolosu=self.webpackChunkkolosu||[]).push([[721],{721:(T,d,n)=>{n.r(d),n.d(d,{ClienteServicioModule:()=>y});var p=n(6895),l=n(7046);let v=(()=>{class t{constructor(){this.id_servicio=0,this.codigo="",this.costo_total=0,this.id_cliente=0,this.id_tipo_servicio=0,this.tipo_servicio=""}static initialize(e){this.ComboServicio(e)}static ComboServicio(e){e.getAll("servicio/lista_tipo_servicio").subscribe({next:i=>{const s=(i.lista_tipo_servicio||[]).map(c=>({label:c.tipo_servicio,value:c.id_tipo_servicio})),m=t.columns.find(c=>"id_tipo_servicio"===c.field);m&&(m.options=s)},error:i=>{console.error("Error cargando opciones de tipo de servicio",i)}})}}return t.columns=[{field:"id_servicio",header:"ID",visibleTable:!1,visibleForm:!1,inputType:"number",required:!1,primaryKey:!0},{field:"codigo",header:"Codigo",visibleTable:!1,visibleForm:!1,inputType:"text",required:!1},{field:"id_tipo_servicio",header:"Tipo servicio",visibleTable:!1,visibleForm:!0,inputType:"select",required:!0,options:[],multiple:!1},{field:"tipo_servicio",header:"Tipo de servicio",visibleTable:!0,visibleForm:!1,inputType:"text",required:!1},{field:"costo_total",header:"Precio",visibleTable:!0,visibleForm:!0,inputType:"number",required:!0},{field:"id_cliente",header:"ID",visibleTable:!1,visibleForm:!1,inputType:"number",required:!1}],t})();var u=n(805),o=n(1571),f=n(6253),h=n(3617),b=n(2453),g=n(1023);const S=[{path:"",component:(()=>{class t{constructor(e,i,r,s){this.messageService=e,this.apiService=i,this.route=r,this.router=s,this.lista_servicios=[],this.loading=!1,this.columnas_servicio=v.columns,this.toolbarButtons=new Array,this.id_cliente=0}ngOnInit(){this.AgregarBotones(),v.initialize(this.apiService),this.route.paramMap.subscribe(e=>{this.id_cliente=Number(e.get("id_cliente")),this.ListarServicios()})}ListarServicios(){this.loading=!0,this.apiService.getAll("servicio/lista_servicio_cliente/"+this.id_cliente).subscribe({next:e=>{console.log(e),this.lista_servicios=JSON.parse(JSON.stringify(e)).lista_servicios_cliente},error:e=>{console.log(e)},complete:()=>{this.loading=!1}})}guardarClienteServicio(e){this.loading=!0,e.id_cliente=this.id_cliente,this.apiService.create("servicio/post_servicio",e).subscribe({next:i=>{var r;const s=null===(r=i?.mensaje)||void 0===r?void 0:r[0];s?this.MensajeError(s):this.ListarServicios()},error:i=>{this.MensajeError("Verifique su conexi\xf3n a internet"),console.log(i)},complete:()=>{this.loading=!1}})}eliminarClienteServicio(e){e.id_servicio&&(this.loading=!0,this.apiService.delete("servicio/eliminar_servicio",e.id_servicio).subscribe({next:()=>{this.ListarServicios()},error:i=>{console.log("Error al eliminar:",i),this.MensajeError("Error al eliminar")},complete:()=>{this.loading=!1}}))}seleccionarServicio(e){this.messageService.clear(),this.MensajeInfo("Servicio "+e.tipo_servicio,!0)}AgregarBotones(){this.toolbarButtons.push({name:"btnAtras",label:"Volver",action:"volveratras",icon:"pi pi-arrow-left",disabled:!0,class:"p-button-rounded p-button-info"}),this.ButtonEnabled("btnAtras",!1)}ButtonClick(e){const{action:i}=e;"volveratras"===i?this.router.navigate(["/rastreo/lista_cliente"]):"onPruba2"===i||console.error("Accion no soportada")}MensajeError(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}MensajeSucces(e){this.messageService.add({severity:"success",summary:"Exito",detail:e})}MensajeInfo(e,i){this.messageService.add(1==i?{severity:"info",summary:"Seleccionado",detail:e}:{severity:"info",summary:"Informaci\xf3n",detail:e})}MensajeAdvertencia(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}ButtonEnabled(e,i){this.toolbarButtons.forEach(r=>{r.name===e&&(r.disabled=i)})}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(u.ez),o.Y36(f.s),o.Y36(l.gz),o.Y36(l.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-cliente-servicio"]],features:[o._Bn([u.ez])],decls:4,vars:7,consts:[[1,"card"],[3,"loading"],["titleTable","Lista de servicios",3,"filterTable","paginator","toolbar","data","columns","buttons","selected","formSave","delete","buttonClick"]],template:function(e,i){1&e&&(o.TgZ(0,"div",0),o._UZ(1,"p-toast")(2,"app-loading",1),o.TgZ(3,"app-tabla-dinamica",2),o.NdJ("selected",function(s){return i.seleccionarServicio(s)})("formSave",function(s){return i.guardarClienteServicio(s)})("delete",function(s){return i.eliminarClienteServicio(s)})("buttonClick",function(s){return i.ButtonClick(s)}),o.qZA()()),2&e&&(o.xp6(2),o.Q6J("loading",i.loading),o.xp6(1),o.Q6J("filterTable",!0)("paginator",!0)("toolbar",!0)("data",i.lista_servicios)("columns",i.columnas_servicio)("buttons",i.toolbarButtons))},dependencies:[h.N,b.FN,g.C]}),t})()}];let C=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[l.Bz.forChild(S),l.Bz]}),t})();var _=n(1511);let y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[p.ez,C,_.m]}),t})()}}]);