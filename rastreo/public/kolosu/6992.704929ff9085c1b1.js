"use strict";(self.webpackChunkkolosu=self.webpackChunkkolosu||[]).push([[6992],{6992:(T,u,a)=>{a.r(u),a.d(u,{ClienteModule:()=>y});var h=a(6895),c=a(6957),d=a(805);let m=(()=>{class t{constructor(){this.id_cliente=0,this.id_persona=0,this.persona="",this.usuario_reg="",this.usuario_mod=null,this.fecha_reg=new Date,this.fecha_mod=null,this.direccion=""}static initialize(e){this.ComboPersona(e)}static ComboPersona(e){e.getAll("persona/lista_persona").subscribe({next:i=>{const o=(i.personas||[]).map(r=>({label:r.nombre+" "+r.apellido_paterno+" "+r.apellido_materno,value:r.id_persona})),p=t.columns.find(r=>"id_persona"===r.field);p&&(p.options=o)},error:i=>{console.error("Error cargando opciones de cliente",i)}})}}return t.columns=[{field:"id_cliente",header:"ID Cliente",visibleTable:!1,visibleForm:!1,inputType:"number",required:!1,primaryKey:!0},{field:"persona",header:"Cliente",visibleTable:!0,visibleForm:!1,inputType:"text",required:!1},{field:"id_persona",header:"Persona",visibleTable:!1,visibleForm:!0,inputType:"select",required:!1,options:[],multiple:!1},{field:"direccion",header:"Direcci\xf3n",visibleTable:!0,visibleForm:!0,inputType:"textarea",required:!0},{field:"fecha_mod",header:"Fecha Mod",visibleTable:!0,visibleForm:!1,inputType:"date",required:!1},{field:"fecha_reg",header:"Fecha Reg",visibleTable:!0,visibleForm:!1,inputType:"datetime",required:!1},{field:"usuario_reg",header:"Usuario Reg",visibleTable:!0,visibleForm:!1,inputType:"datetime",required:!1},{field:"usuario_mod",header:"Usuario Mod",visibleTable:!0,visibleForm:!1,inputType:"datetime",required:!1}],t})();var n=a(1571),b=a(6253),f=a(3617),v=a(2453),g=a(1023);const C=[{path:"",component:(()=>{class t{constructor(e,i,s){this.messageService=e,this.apiService=i,this.router=s,this.loading=!1,this.lista_clientes=[],this.columnas_cliente=m.columns,this.toolbarButtons=new Array,this.es_admin=!1}ngOnInit(){this.ListarClientes(),m.initialize(this.apiService),this.AgregarBotones(),this.verSession()}verSession(){console.log("ver session",JSON.parse(localStorage.getItem("accesos")||"{}")),this.es_admin=1!=JSON.parse(localStorage.getItem("accesos")||"{}").sesion}ListarClientes(){this.loading=!0,this.apiService.getAll("cliente/lista_clientes").subscribe({next:e=>{console.log(e),this.lista_clientes=JSON.parse(JSON.stringify(e)).lista_clientes},error:e=>{console.log(e)},complete:()=>{this.loading=!1}})}guardarCliente(e){this.loading=!0,e.id_persona=JSON.parse(JSON.stringify(e)).id_persona.value,this.apiService.create("cliente/post_cliente",e).subscribe({next:i=>{var s;const o=null===(s=i?.mensaje)||void 0===s?void 0:s[0];o?this.MensajeError(o):this.ListarClientes()},error:i=>{this.MensajeError("Verifique su conexi\xf3n a internet"),console.log(i)},complete:()=>{this.loading=!1}})}eliminarCliente(e){e.id_cliente&&(this.loading=!0,this.apiService.delete("cliente/eliminar_cliente",e.id_cliente).subscribe({next:()=>{this.ListarClientes()},error:i=>{console.log("Error al eliminar:",i),this.MensajeError("Error al eliminar")},complete:()=>{this.loading=!1}}))}seleccionarCliente(e){this.messageService.clear(),this.MensajeInfo(e.persona,!0),this.ButtonEnabled("btnVehiculo",!1),this.ButtonEnabled("btnServicio",!1),this.ButtonEnabled("btnPago",!1)}deshacerSeleccionCliente(e){this.ButtonEnabled("btnVehiculo",!0),this.ButtonEnabled("btnServicio",!0),this.ButtonEnabled("btnPago",!0)}AgregarBotones(){this.toolbarButtons.push({name:"btnVehiculo",label:"Veh\xedculos",action:"onVeiculos",icon:"pi pi-car",disabled:!0,class:"p-button-rounded p-button-info"}),this.toolbarButtons.push({name:"btnServicio",label:"Servicios",action:"onServicios",icon:"pi pi-link",disabled:!0,class:"p-button-rounded p-button-warning"}),this.toolbarButtons.push({name:"btnPago",label:"Pagos",action:"onPagos",icon:"pi pi-dollar",disabled:!0,class:"p-button-rounded p-button-success"})}ButtonClick(e){const{action:i,rowData:s}=e;"onVeiculos"===i?this.router.navigate(["/rastreo/lista_cliente_vehiculo",s.id_cliente]):"onServicios"===i?this.router.navigate(["/rastreo/lista_cliente_servicio",s.id_cliente]):"onPagos"===i?this.router.navigate(["/rastreo/lista_cliente_pago",s.id_cliente]):console.error("Acci\xf3n no soportada")}MensajeError(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}MensajeSucces(e){this.messageService.add({severity:"success",summary:"Exito",detail:e})}MensajeInfo(e,i){this.messageService.add(1==i?{severity:"info",summary:"Seleccionado",detail:e}:{severity:"info",summary:"Informaci\xf3n",detail:e})}MensajeAdvertencia(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}ButtonEnabled(e,i){this.toolbarButtons.forEach(s=>{s.name===e&&(s.disabled=i)})}}return t.\u0275fac=function(e){return new(e||t)(n.Y36(d.ez),n.Y36(b.s),n.Y36(c.F0))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-cliente"]],features:[n._Bn([d.ez])],decls:4,vars:8,consts:[[1,"card"],[3,"loading"],["titleTable","Lista de clientes",3,"buttons","buttonNew","buttonEdit","buttonDelete","toolbar","columns","data","selected","Unselect","buttonClick","formSave","delete"]],template:function(e,i){1&e&&(n.TgZ(0,"div",0),n._UZ(1,"p-toast")(2,"app-loading",1),n.TgZ(3,"app-tabla-dinamica",2),n.NdJ("selected",function(o){return i.seleccionarCliente(o)})("Unselect",function(o){return i.deshacerSeleccionCliente(o)})("buttonClick",function(o){return i.ButtonClick(o)})("formSave",function(o){return i.guardarCliente(o)})("delete",function(o){return i.eliminarCliente(o)}),n.qZA()()),2&e&&(n.xp6(2),n.Q6J("loading",i.loading),n.xp6(1),n.Q6J("buttons",i.toolbarButtons)("buttonNew",i.es_admin)("buttonEdit",i.es_admin)("buttonDelete",i.es_admin)("toolbar",i.es_admin)("columns",i.columnas_cliente)("data",i.lista_clientes))},dependencies:[f.N,v.FN,g.C]}),t})()}];let _=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[c.Bz.forChild(C),c.Bz]}),t})();var S=a(1511);let y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[h.ez,_,S.m]}),t})()}}]);